<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HomeWorks LEGAL Payroll Register & Document Architect</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Lora:wght@400;700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --primary-color: #002a24; /* Original Dark Green */
            --secondary-color: #004d40; /* Original Medium Green */
            --accent-color: #D4AF37; /* Original Gold */
            --text-color: #333333;
            --bg-color: #f8f9fa;
            --light-gray: #e0e0e0;
            --white: #ffffff;
            --danger-color: #e74c3c;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--light-gray);
            margin: 0;
            padding: 20px;
            font-size: 11pt;
            color: var(--text-color);
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: var(--white);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            overflow: hidden;
            position: relative;
        }

        header {
            background: linear-gradient(to right, #004d40, #000000);
            color: var(--white);
            padding: 20px 40px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .logo {
            height: 100px; /* Adjusted for better fit */
            border-radius: 8px;
        }

        .app-title {
            font-size: 28px;
            font-family: 'Playfair Display', serif;
            font-weight: 700;
        }

        .app-subtitle {
            font-size: 16px;
            font-family: 'Lora', serif;
            opacity: 0.9;
            margin-top: 5px;
        }

        .nav-tabs {
            display: flex;
            background: var(--bg-color);
            border-bottom: 1px solid #dce1e5;
        }

        .tab {
            padding: 18px 30px;
            cursor: pointer;
            font-weight: 600;
            color: var(--primary-color);
            transition: all 0.3s ease;
            position: relative;
            font-family: 'Lora', serif;
        }

        .tab.active {
            background: var(--white);
            color: var(--accent-color);
        }

        .tab.active:after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 100%;
            height: 3px;
            background: var(--accent-color);
        }
        
        .tab-content {
            padding: 30px;
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .section-title {
            font-family: 'Playfair Display', serif;
            color: var(--secondary-color);
            font-size: 22pt;
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 15px;
            margin-bottom: 25px;
        }
        
        .card {
            background: var(--white);
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            padding: 25px;
            margin-bottom: 30px;
            border: 1px solid #eaeff5;
        }

        .controls-row {
            display: flex;
            gap: 20px;
            margin-bottom: 25px;
            flex-wrap: wrap;
            align-items: flex-end;
        }

        .control-group {
            flex: 1;
            min-width: 200px;
        }

        .control-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--primary-color);
        }

        .control-group input,
        .control-group select,
        .control-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #dce1e5;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s;
            box-sizing: border-box;
            font-family: 'Roboto', sans-serif;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background-color: var(--secondary-color);
            color: var(--white);
            width: 100%;
            justify-content: center;
            transition: all 0.3s ease;
        }
        .btn:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px -5px rgba(0,0,0,0.1), 0 10px 10px -5px rgba(0,0,0,0.04);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            font-size: 10pt;
        }

        th, td {
            border: 1px solid #dee2e6;
            padding: 10px;
            text-align: left;
            vertical-align: top;
        }

        th {
            background-color: var(--bg-color);
            font-weight: 700;
            font-family: 'Lora', serif;
        }
        
        .table-container {
            overflow-x: auto;
        }

        .payslip, .certificate {
            border: 1px solid #dce1e5;
            border-radius: 12px;
            padding: 25px;
            background: white;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            margin-top: 20px;
        }
        
        .payslip-header, .certificate-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            border-bottom: 4px solid var(--primary-color);
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        
        .document-title-area h1 {
            font-family: 'Playfair Display', serif;
            color: var(--primary-color);
            font-size: 28pt;
            margin: 0;
            text-align: right;
        }

        .footer {
            text-align: center;
            font-size: 9pt;
            color: #777;
            margin-top: 40px;
            border-top: 1px solid #ccc;
            padding-top: 20px;
        }
        
        #payslip-view, #certificate-view {
            margin-top: 20px;
        }
        
        .payslip-section-title {
            font-family: 'Lora', serif;
            font-weight: 700;
            color: var(--secondary-color);
            background-color: var(--bg-color);
            padding: 8px;
            margin-top: 20px;
            border-radius: 4px;
        }
        
        .payslip-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .payslip-grid-item table {
            margin-top: 5px;
        }

        .payslip-grid-item table td {
            border: none;
            padding: 4px 0;
        }

        .payslip-grid-item table td:first-child {
            font-weight: 500;
            width: 40%;
        }

        #file-name {
            margin-top: 10px;
            font-style: italic;
            color: var(--secondary-color);
        }
        
        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background: var(--white);
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            position: relative;
            transform: translateY(-50px);
            transition: transform 0.3s ease;
        }
        .modal-overlay.active .modal-content {
            transform: translateY(0);
        }
        .modal-close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-color);
        }

        /* Animation Styles */
        @keyframes fadeIn {
          from { opacity: 0; transform: translateY(10px); }
          to { opacity: 1; transform: translateY(0); }
        }
        .animate-fadeIn { animation: fadeIn 0.8s ease-out forwards; }
        
        @keyframes float {
            0% { transform: translateY(0px) rotate(0deg); opacity: 0.5; }
            50% { transform: translateY(-30px) rotate(180deg); opacity: 1; }
            100% { transform: translateY(0px) rotate(360deg); opacity: 0.5; }
        }
        .ember {
            position: absolute;
            border-radius: 50%;
            animation: float 8s ease-in-out infinite;
        }
        .animation-delay-1 { animation-delay: 1s; }
        .animation-delay-2 { animation-delay: 2s; }
        .animation-delay-3 { animation-delay: 3s; }

        /* Print-specific styles */
        @media print {
            body {
                background-color: #fff;
                padding: 0;
                margin: 0;
            }
            .container, .card, .payslip, .certificate {
                box-shadow: none;
                border: none;
                margin: 0;
                padding: 0;
                width: 100%;
                max-width: 100%;
            }
            .no-print {
                display: none;
            }
            @page {
                size: letter;
                margin: 0.5in;
            }
        }

    </style>
</head>
<body>
    <div class="container">
        <!-- Floating Embers Background -->
        <div class="ember w-3 h-3 bg-teal-400/50 blur-sm left-[10%] top-[20%] animation-delay-1"></div>
        <div class="ember w-4 h-4 bg-yellow-500/50 blur-sm left-[80%] top-[10%]"></div>
        <div class="ember w-2 h-2 bg-teal-300/50 blur-sm left-[90%] top-[60%] animation-delay-2"></div>
        <div class="ember w-3 h-3 bg-yellow-400/50 blur left-[5%] top-[70%] animation-delay-3"></div>
        <div class="ember w-2 h-2 bg-teal-500/50 blur-sm left-[45%] top-[90%]"></div>

        <header class="no-print">
            <div>
                <div class="app-title">HomeWorks Document Architect</div>
                <div class="app-subtitle">Payroll Register ‚Ä¢ Payslip Generator ‚Ä¢ Certificate Generator</div>
            </div>
            <img src="https://github.com/Z-Insights/HomeWorks/blob/main/HWPM%20Logo%203D.png?raw=true" alt="HomeWorks Logo" class="logo">
        </header>
        
        <div class="nav-tabs no-print">
            <div class="tab active" data-tab="payroll">Payroll Register</div>
            <div class="tab" data-tab="payslips">Payslip Generator</div>
            <div class="tab" data-tab="certificates">Certificate Generator</div>
            <div class="tab" data-tab="database">Employee Database</div>
        </div>
        
        <!-- Tab Content Wrapper -->
        <div class="animate-fadeIn">
            <!-- Payroll Register Tab -->
            <div class="tab-content active" id="payroll-tab">
                <div class="card">
                    <h2 class="section-title">Weekly Payroll Register</h2>
                    <div class="controls-row no-print">
                        <div class="control-group">
                            <label for="payrollFile">Upload Weekly Timesheet (.csv, .xlsx)</label>
                            <input type="file" id="payrollFile" accept=".csv,.xlsx">
                            <div id="file-name"></div>
                        </div>
                         <div class="control-group">
                            <label for="exchangeRate">USD to PHP Exchange Rate</label>
                            <input type="number" id="exchangeRate" value="58.75" step="0.01">
                        </div>
                        <div class="control-group">
                            <label for="payPeriodStart">Pay Period Start</label>
                            <input type="date" id="payPeriodStart">
                        </div>
                        <div class="control-group">
                            <label for="payPeriodEnd">Pay Period End</label>
                            <input type="date" id="payPeriodEnd">
                        </div>
                        <div class="control-group">
                            <button class="btn" id="processPayrollBtn">Process Payroll</button>
                        </div>
                         <div class="control-group">
                            <button class="btn" id="downloadTemplateBtn" style="background-color: var(--accent-color); color: var(--primary-color);">Download Template</button>
                        </div>
                         <div class="control-group">
                            <button class="btn" id="printReportBtn" style="background-color: var(--accent-color); color: var(--primary-color);">Print Report</button>
                        </div>
                    </div>
                    <!-- NEW INSTRUCTION BLOCK -->
                    <div class="text-center text-sm text-gray-600 italic flex items-center justify-center gap-2 -mt-4 mb-4 no-print">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                          <path d="M5.5 2A1.5 1.5 0 0 0 4 3.5v1A1.5 1.5 0 0 0 5.5 6h5A1.5 1.5 0 0 0 12 4.5v-1A1.5 1.5 0 0 0 10.5 2h-5zm0 1h5a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-5a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5z"/>
                          <path d="M1.5 7A1.5 1.5 0 0 0 0 8.5v1A1.5 1.5 0 0 0 1.5 11h13A1.5 1.5 0 0 0 16 9.5v-1A1.5 1.5 0 0 0 14.5 7h-13zm0 1h13a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5z"/>
                        </svg>
                        <span>For best results, set page orientation to <b>Landscape</b> to view the full table.</span>
                    </div>

                    <div class="table-container">
                        <table id="payroll-register-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Full Name</th>
                                    <th>Rate ($)</th>
                                    <th>Hours</th>
                                    <th>PTO Hours</th>
                                    <th>Gross Hourly Pay ($)</th>
                                    <th>Gross PTO ($)</th>
                                    <th>Commissions ($)</th>
                                    <th>S-STARS Bonus ($)</th>
                                    <th>Health Card ($)</th>
                                    <th>SSS Reimb. ($)</th>
                                    <th>Pag-IBIG Reimb. ($)</th>
                                    <th>PhilHealth Reimb. ($)</th>
                                    <th>Cash Adv/Loans ($)</th>
                                    <th>Adjustments ($)</th>
                                    <th>Total Gross Pay ($)</th>
                                    <th>Take Home Pay ($)</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                            <tfoot></tfoot>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Payslip Generator Tab -->
            <div class="tab-content" id="payslips-tab">
                <div class="card">
                    <h2 class="section-title">Payslip Generator</h2>
                     <div class="controls-row no-print">
                        <div class="control-group">
                            <label for="payslipEmployeeSelect">Select Employee</label>
                            <select id="payslipEmployeeSelect">
                                <option value="">-- Select Employee --</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <button class="btn" id="generatePayslipBtn">Generate Payslip</button>
                        </div>
                         <div class="control-group">
                            <button class="btn" id="printPayslipBtn" style="background-color: var(--accent-color); color: var(--primary-color);">Print Payslip</button>
                        </div>
                    </div>
                    <div id="payslip-view"></div>
                </div>
            </div>

            <!-- Certificate Generator Tab -->
            <div class="tab-content" id="certificates-tab">
                <div class="card">
                     <h2 class="section-title">Certificate Generator</h2>
                     <div class="controls-row no-print">
                        <div class="control-group">
                            <label for="certEmployeeSelect">Select Employee</label>
                            <select id="certEmployeeSelect">
                                 <option value="">-- Select Employee --</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label for="certDate">Date Issued</label>
                            <input type="date" id="certDate">
                        </div>
                        <div class="control-group">
                            <button class="btn" id="generateCertBtn">Generate Certificate</button>
                        </div>
                         <div class="control-group">
                            <button class="btn" id="printCertBtn" style="background-color: var(--accent-color); color: var(--primary-color);">Print Certificate</button>
                        </div>
                    </div>
                    <div id="certificate-view"></div>
                </div>
            </div>
            
            <!-- Employee Database Tab -->
            <div class="tab-content" id="database-tab">
                <div class="card">
                    <h2 class="section-title">Employee Database</h2>
                     <div class="table-container">
                        <table id="employee-database-table">
                            <thead>
                                <tr>
                                    <th>Employee ID</th>
                                    <th>Full Name</th>
                                    <th>Designation</th>
                                    <th>Company</th>
                                    <th>Status</th>
                                    <th>Hourly Rate ($)</th>
                                    <th>Work Email</th>
                                    <th>Date of Joining</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Footer -->
        <footer class="main-footer no-print" style="background: var(--primary-color); color: var(--white); padding: 40px 30px; margin-top: 30px; text-align: center;">
             <button id="openModalBtn" class="btn" style="max-width: 250px; margin: 0 auto 30px auto; background-color: var(--accent-color); color: var(--primary-color);">Contact Us</button>
             <div class="footer-bottom" style="border-top: 1px solid var(--secondary-color); padding-top: 20px;">
                 <p>A Project coded by <strong>Z-Insight</strong> ‚Äî All Rights Reserved</p>
                 <p>Custom Project Apps: <a href="mailto:z-bridges@z-insightxy.com" style="color: var(--accent-color);">z-bridges@z-insightxy.com</a></p>
             </div>
        </footer>

    </div>

    <!-- Contact Modal -->
    <div id="contactModal" class="modal-overlay no-print" role="dialog" aria-modal="true">
        <div class="modal-content">
            <button id="closeModalBtn" class="modal-close-btn" aria-label="Close contact form">&times;</button>
            <h2 class="section-title">Contact Us</h2>
            <form id="contact-form">
                <div class="control-group">
                    <label for="contactName">Name</label>
                    <input type="text" id="contactName" placeholder="e.g. John Doe" required>
                </div>
                <div class="control-group">
                    <label for="contactWhatsapp">WhatsApp Number</label>
                    <input type="tel" id="contactWhatsapp" placeholder="+63 912 345 6789">
                </div>
                <div class="control-group">
                    <label for="contactEmail">Email</label>
                    <input type="email" id="contactEmail" placeholder="name@example.com" required>
                </div>
                <div class="control-group">
                    <label for="contactConcern">Concern</label>
                    <select id="contactConcern">
                        <option>Custom App Creation</option>
                        <option>General Inquiry</option>
                        <option>Report an Error</option>
                        <option>Other</option>
                    </select>
                </div>
                <div class="control-group" style="grid-column: 1 / -1;">
                    <label for="contactMessage">Message</label>
                    <textarea id="contactMessage" rows="4" placeholder="How can we help you?" required></textarea>
                </div>
                <div class="control-group" style="grid-column: 1 / -1;">
                    <button type="submit" class="btn" style="background-color: var(--accent-color); color: var(--primary-color);">
                        Send Message
                    </button>
                </div>
            </form>
            <div id="form-message" style="display: none; padding: 10px; margin-top: 15px; border-radius: 8px; text-align: center; font-weight: 600;">
                <!-- Message inserted via JavaScript -->
            </div>
        </div>
    </div>


    <script>
    // Copyright 2025 Z-Insight. All Rights Reserved.
    // This script has been intentionally obfuscated to protect intellectual property.
    // --- EMBEDDED KNOWLEDGE BASE & DATA ---
    const employeeDatabase=[{id:"HWPM-0000",fullName:"Zaphyr Zur Pomicpic",designation:"Director of Operations",company:"HWPM, BRCA, PILTD",status:"Active",rate:12,workEmail:"zaphyrzurpomicpic@gmail.com",joinDate:"2018-11-26",address:"Block 2 Lot 6 Rambutan St. Tierra Verde Village, Sasa, Davao, Davao Del Sur, 8000, Philippines",sss:"34-1234567-8",pagibig:"1234-5678-9012",philhealth:"01-0123456789-0",tin:"123-456-789-000",bankName:"BDO",accountNumber:"0012-3456-7890"},{id:"HWPM-1004",fullName:"Fatima May Namalata",designation:"Business Development Manager",company:"HWPM",status:"Active",rate:6,workEmail:"fatima@hwpmmd.com",joinDate:"2020-02-17",address:"48 MARS STREET MACASANDIG, CAGAYAN DE ORO, MISAMIS ORIENTAL, 9000, Philippines",sss:"34-2345678-9",pagibig:"2345-6789-0123",philhealth:"02-0234567890-1",tin:"234-567-890-000",bankName:"BPI",accountNumber:"1123-4567-8901"},{id:"HWPM-1050",fullName:"Shelly (Michelle) Jose",designation:"Maintenance Manager",company:"BRCA",status:"Active",rate:4.75,workEmail:"vendorsuccess@llmcpro.com",joinDate:"2022-03-18",address:"Block 1 Lot 49 Kensington 21, Lancaster New City, General Trias, Cavite, 4107, Philippines",sss:"34-3456789-0",pagibig:"3456-7890-1234",philhealth:"03-0345678901-2",tin:"345-678-901-000",bankName:"Metrobank",accountNumber:"2234-5678-9012"},{id:"HWPM-1005",fullName:"Mary Galillaga",designation:"Customer Success Rep",company:"HWPM",status:"Active",rate:4.25,workEmail:"mary@hwpmmd.com",joinDate:"2022-05-06",address:"7350 Maria Clara St. La Huerta, Paranaque City, Manila, 1700, Philippines",sss:"34-4567890-1",pagibig:"4567-8901-2345",philhealth:"04-0456789012-3",tin:"456-789-012-000",bankName:"BPI",accountNumber:"3345-6789-0123"},{id:"HWPM-1070",fullName:"Belle (Maybelline) Martinez",designation:"Customer Success Rep",company:"HWPM",status:"Active",rate:5,workEmail:"mabrosendo17@gmail.com",joinDate:"2023-01-09",address:"89 S Mateo Street, Taytay, Rizal, 1920, Philippines",sss:"34-5678901-2",pagibig:"5678-9012-3456",philhealth:"05-0567890123-4",tin:"567-890-123-000",bankName:"BDO",accountNumber:"4456-7890-1234"},{id:"HWPM-2050",fullName:"Christine Jeunesse Belmes",designation:"Client Success Manager",company:"HWPM",status:"Active",rate:6,workEmail:"christine.b@hwpmmd.com",joinDate:"2024-04-22",address:"Block 26 Lot 22B Liwayway Homes Subd. Anabu 1C, Imus, Cavite, 4103, Philippines",sss:"34-6789012-3",pagibig:"6789-0123-4567",philhealth:"06-0678901234-5",tin:"678-901-234-000",bankName:"Security Bank",accountNumber:"5567-8901-2345"},{id:"HWPM-2021",fullName:"Clyde Vandamme Martin",designation:"General Success Coordinator",company:"HWPM",status:"Active",rate:3.75,workEmail:"clydem@hwpmmd.com",joinDate:"2024-10-07",address:"Purok Mahalika, Brgy. Kimagango, Midsayap, North Cotabato, 9410, Philippines",sss:"34-7890123-4",pagibig:"7890-1234-5678",philhealth:"07-0789012345-6",tin:"789-012-345-000",bankName:"BPI",accountNumber:"6678-9012-3456"},{id:"HWPM-2024",fullName:"Janela Marie Brosas",designation:"Customer Success Rep",company:"HWPM",status:"Active",rate:3.75,workEmail:"janela@hwpmmd.com",joinDate:"2024-10-07",address:"Blk 47 Lot 14 Zontaville, Antipolo, Rizal, 1870, Philippines",sss:"34-8901234-5",pagibig:"8901-2345-6789",philhealth:"08-0890123456-7",tin:"890-123-456-000",bankName:"BDO",accountNumber:"7789-0123-4567"},{id:"N/A-Sheryl",fullName:"Sheryl Bautista",designation:"Bookkeeping Coordinator",company:"N/A",status:"Active",rate:3.75,workEmail:"N/A",joinDate:"N/A",address:"54 Gabronino Alley Bagong Barrio, Caloocan City, Metro Manila, 1400, Philippines",sss:"34-9012345-6",pagibig:"9012-3456-7890",philhealth:"09-0901234567-8",tin:"901-234-567-000",bankName:"Metrobank",accountNumber:"8890-1234-5678"},{id:"BRCA-006",fullName:"Jzel Ann Marie Aliviado",designation:"Client Success Manager",company:"BRCA",status:"Active",rate:5.5,workEmail:"jamaliviado@gmail.com",joinDate:"2023-01-31",address:"Blk 1 Lot 31 Deca Homes, Mandaue, Cebu, 6014",sss:"34-0123456-7",pagibig:"0123-4567-8901",philhealth:"10-1012345678-9",tin:"012-345-678-000",bankName:"BPI",accountNumber:"9901-2345-6789"},{id:"BRCA-1014",fullName:"Anson Gel Pangan",designation:"Accounting Liaison Officer",company:"BRCA, PILTD",status:"Active",rate:5.25,workEmail:"clientsupport03@baltimore...",joinDate:"2023-11-20",address:"1889 CBY Barracks II Tala, Caloocan City, Metro Manila, 1427, Philippines",sss:"34-1123456-8",pagibig:"1123-4567-8901",philhealth:"11-1123456789-0",tin:"112-345-678-000",bankName:"BDO",accountNumber:"1012-3456-7890"},{id:"BRCA-1015",fullName:"Adrian Arcilla",designation:"Client Support Associate",company:"BRCA",status:"Active",rate:4.5,workEmail:"adrianarcilla93@gmail.com",joinDate:"2025-02-04",address:"488 Anabu Road, Anabu 1-C, Imus, Cavite, 4103, Philippines",sss:"34-2234567-9",pagibig:"2234-5678-9012",philhealth:"12-1234567890-1",tin:"223-456-789-000",bankName:"Metrobank",accountNumber:"2123-4567-8901"}];let processedPayrollData=[],currentExchangeRate=58.75;document.addEventListener("DOMContentLoaded",function(){const e=document.querySelectorAll(".tab"),t=document.querySelectorAll(".tab-content"),a=document.getElementById("payrollFile"),l=document.getElementById("processPayrollBtn"),n=document.getElementById("downloadTemplateBtn"),o=document.querySelector("#payroll-register-table tbody"),r=document.querySelector("#employee-database-table tbody"),i=document.getElementById("payslipEmployeeSelect"),s=document.getElementById("certEmployeeSelect"),c=document.getElementById("generatePayslipBtn"),d=document.getElementById("generateCertBtn"),p=document.getElementById("payslip-view"),u=document.getElementById("certificate-view"),m=document.getElementById("printReportBtn"),y=document.getElementById("printPayslipBtn"),g=document.getElementById("printCertBtn"),h=document.getElementById("file-name"),f=document.getElementById("contact-form"),v=document.getElementById("contactModal"),b=document.getElementById("openModalBtn"),E=document.getElementById("closeModalBtn"),L=new Date,k=new Date(L.setDate(L.getDate()-L.getDay()+1)),H=new Date(k);function x(e){processedPayrollData=[],headerRowIndex=e.findIndex(e=>e.map(e=>String(e||"").toLowerCase()).includes("employee")),-1===headerRowIndex?alert("Could not find a valid header row in the timesheet. The header must contain a column named 'Employee'."):(_=e[headerRowIndex].map(e=>String(e||"").trim().toLowerCase()),A=e.slice(headerRowIndex+1),w={employee:_.indexOf("employee"),"weekly hours rendered":_.indexOf("weekly hours rendered"),"paid timeoff hours":_.indexOf("paid timeoff hours"),commissions:_.indexOf("commissions"),"s-stars bonus":_.indexOf("s-stars bonus"),"health card credit":_.indexOf("health card credit"),sss:_.indexOf("sss"),"pag ibig":_.indexOf("pag ibig"),philhealth:_.indexOf("philhealth"),"cash adv/loans":_.indexOf("cash adv/loans"),"compliance adjustment":_.indexOf("compliance adjustment")},A.forEach(e=>{const t=e[w.employee];if(t){const a=employeeDatabase.find(e=>e.fullName.toLowerCase()===t.toLowerCase());if(a){const t=e=>parseFloat(e[w[key]])||0,l=t("weekly hours rendered"),n=t("paid timeoff hours"),o=a.rate||0,r=l*o,i=n*o,s=t("commissions"),c=t("s-stars bonus"),d=t("health card credit"),p=t("sss"),u=t("pag ibig"),m=t("philhealth"),y=t("cash adv/loans"),g=t("compliance adjustment"),h=r+i+s+c+d+p+u+m+g;processedPayrollData.push({id:a.id,fullName:a.fullName,rate:o,weeklyHours:l,ptoHours:n,grossHourlyPay:r,grossPtoPay:i,commissions:s,bonus:c,healthCard:d,sss:p,pagibig:u,philhealth:m,loans:y,adjustments:g,totalGrossPay:h,takeHomePay:h-y})}else console.warn(`Employee not found in database: ${t}`)}}),C(),S(),alert("Payroll processed successfully. You can now generate slips and certificates."))}function C(){o.innerHTML="";let e={weeklyHours:0,ptoHours:0,grossHourlyPay:0,grossPtoPay:0,commissions:0,bonus:0,healthCard:0,sss:0,pagibig:0,philhealth:0,loans:0,adjustments:0,totalGrossPay:0,takeHomePay:0};processedPayrollData.forEach(t=>{const a=document.createElement("tr");a.innerHTML=`\n                    <td>${t.id}</td><td>${t.fullName}</td><td>${t.rate.toFixed(2)}</td>\n                    <td>${t.weeklyHours.toFixed(2)}</td><td>${t.ptoHours.toFixed(2)}</td>\n                    <td>${t.grossHourlyPay.toFixed(2)}</td><td>${t.grossPtoPay.toFixed(2)}</td>\n                    <td>${t.commissions.toFixed(2)}</td><td>${t.bonus.toFixed(2)}</td>\n                    <td>${t.healthCard.toFixed(2)}</td><td>${t.sss.toFixed(2)}</td>\n                    <td>${t.pagibig.toFixed(2)}</td><td>${t.philhealth.toFixed(2)}</td>\n                    <td>${t.loans.toFixed(2)}</td><td>${t.adjustments.toFixed(2)}</td>\n                    <td><strong>${t.totalGrossPay.toFixed(2)}</strong></td><td><strong>${t.takeHomePay.toFixed(2)}</strong></td>\n                `,o.appendChild(a);for(const a in e)e[a]+=t[a]||0});const t=document.querySelector("#payroll-register-table tfoot");t.innerHTML=`\n                <tr style="font-weight: bold; background-color: var(--bg-color);">\n                    <td colspan="3">TOTALS</td>\n                    <td>${e.weeklyHours.toFixed(2)}</td><td>${e.ptoHours.toFixed(2)}</td>\n                    <td>${e.grossHourlyPay.toFixed(2)}</td><td>${e.grossPtoPay.toFixed(2)}</td>\n                    <td>${e.commissions.toFixed(2)}</td><td>${e.bonus.toFixed(2)}</td>\n                    <td>${e.healthCard.toFixed(2)}</td><td>${e.sss.toFixed(2)}</td>\n                    <td>${e.pagibig.toFixed(2)}</td><td>${e.philhealth.toFixed(2)}</td>\n                    <td>${e.loans.toFixed(2)}</td><td>${e.adjustments.toFixed(2)}</td>\n                    <td>${e.totalGrossPay.toFixed(2)}</td><td>${e.takeHomePay.toFixed(2)}</td>\n                </tr>\n            `}function S(){i.innerHTML='<option value="">-- Select Employee --</option>',s.innerHTML='<option value="">-- Select Employee --</option>',processedPayrollData.forEach(e=>{const t=`<option value="${e.id}">${e.fullName}</option>`;i.innerHTML+=t,s.innerHTML+=t})}function P(e,t){if(!e||!t)return void(p.innerHTML='<p style="color: var(--danger-color);">Could not generate slip. Data not found.</p>');const a=t=>(t*currentExchangeRate).toLocaleString("en-US",{style:"currency",currency:"PHP"}),l=e.grossHourlyPay+e.grossPtoPay+e.commissions+e.bonus,n=e.sss,o=e.pagibig,r=e.philhealth,i=e.adjustments,s=e.loans,c=n+o+r,d=c+i+s,u=l-d,m=c,y=u+m,g=new Date(document.getElementById("payPeriodStart").value).toLocaleDateString("en-US",{month:"long",day:"numeric"}),h=new Date(document.getElementById("payPeriodEnd").value).toLocaleDateString("en-US",{day:"numeric",year:"numeric"}),f=new Date(document.getElementById("payPeriodEnd").value);f.setDate(f.getDate()+1),p.innerHTML=`\n                <div class="payslip" id="slip-to-print">\n                    <div class="slip-header">\n                        <div class="logo-area">\n                            <img src="https://github.com/Z-Insights/HomeWorks/blob/main/HWPM%20Logo%203D.png?raw=true" alt="HomeWorks Logo" style="max-height: 70px; border-radius: 8px;">\n                        </div>\n                        <div class="document-title-area">\n                            <h1>Weekly Payslip</h1>\n                            <p style="text-align:right; font-family: 'Lora', serif;">\n                                <strong>Pay Period:</strong> ${g} - ${h}<br>\n                                <strong>Pay Date:</strong> ${f.toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})}\n                            </p>\n                        </div>\n                    </div>\n                    \n                    <div class="slip-grid">\n                        <div class="slip-grid-item">\n                            <h3 class="slip-section-title">üë§ Employee Details</h3>\n                            <table>\n                                <tr><td>Full Name:</td><td>${t.fullName}</td></tr>\n                                <tr><td>Employee ID:</td><td>${t.id}</td></tr>\n                                <tr><td>Position:</td><td>${t.designation}</td></tr>\n                                <tr><td>Work Location:</td><td>${t.address.split(",").slice(-3).join(", ").trim()}</td></tr>\n                                <tr><td>Govt. IDs:</td><td>SSS: ${t.sss} | PhilHealth: ${t.philhealth} | Pag-IBIG: ${t.pagibig} | TIN: ${t.tin}</td></tr>\n                            </table>\n                        </div>\n                        <div class="slip-grid-item">\n                            <h3 class="slip-section-title">üåê Employer Details</h3>\n                             <table>\n                                <tr><td>Company:</td><td>HomeWorks Property Management LLC</td></tr>\n                                <tr><td>Address:</td><td>100 West Road, Suite 300, Towson, MD 21204</td></tr>\n                                <tr><td>Contact:</td><td>payroll@homeworks.com</td></tr>\n                            </table>\n                        </div>\n                    </div>\n                    \n                    <h3 class="slip-section-title">üíµ Compensation Breakdown</h3>\n                    <table style="font-size: 11pt;">\n                       <thead><tr><th>Description</th><th style="text-align:right;">Amount (PHP)</th></tr></thead>\n                       <tbody>\n                            <tr><td>Basic Pay (${e.weeklyHours.toFixed(2)} hrs @ $${e.rate.toFixed(2)}/hr)</td><td style="text-align:right;">${a(e.grossHourlyPay)}</td></tr>\n                            <tr><td>Overtime/PTO Pay (${e.ptoHours.toFixed(2)} hrs)</td><td style="text-align:right;">${a(e.grossPtoPay)}</td></tr>\n                            <tr><td>Performance Bonus / S-STARS</td><td style="text-align:right;">${a(e.commissions+e.bonus)}</td></tr>\n                            <tr style="font-weight:bold; background-color: var(--bg-color);"><td>Gross Pay</td><td style="text-align:right;">${a(l)}</td></tr>\n                       </tbody>\n                    </table>\n\n                    <h3 class="slip-section-title">üìâ Deductions (Employee-Paid, Reimbursable by Company)</h3>\n                    <table style="font-size: 11pt;">\n                       <thead><tr><th>Description</th><th style="text-align:right;">Amount (PHP)</th></tr></thead>\n                       <tbody>\n                            <tr><td>SSS Contribution</td><td style="text-align:right;">(${a(n)})</td></tr>\n                            <tr><td>PhilHealth Contribution</td><td style="text-align:right;">(${a(r)})</td></tr>\n                            <tr><td>Pag-IBIG Contribution</td><td style="text-align:right;">(${a(o)})</td></tr>\n                            <tr><td>Withholding Tax (from Adjustments)</td><td style="text-align:right;">(${a(i)})</td></tr>\n                            <tr><td>Cash Advance / Loans</td><td style="text-align:right;">(${a(s)})</td></tr>\n                            <tr style="font-weight:bold; background-color: var(--bg-color);"><td>Total Deductions</td><td style="text-align:right;">(${a(d)})</td></tr>\n                       </tbody>\n                    </table>\n                    \n                    <h3 class="slip-section-title">üí∞ Net Pay & Reimbursement</h3>\n                     <table style="font-size: 11pt;">\n                       <thead><tr><th>Description</th><th style="text-align:right;">Amount (PHP)</th></tr></thead>\n                       <tbody>\n                            <tr style="font-weight:bold;"><td>Net Pay (Take-Home)</td><td style="text-align:right;">${a(u)}</td></tr>\n                            <tr><td>Reimbursement of Gov‚Äôt Deductions</td><td style="text-align:right;">${a(m)}</td></tr>\n                            <tr style="font-weight:bold; background-color: var(--secondary-color); color: var(--white); font-size: 1.2em;"><td>Total Credited to Bank</td><td style="text-align:right;">${a(y)}</td></tr>\n                       </tbody>\n                    </table>\n\n                    <div class="slip-grid" style="margin-top: 20px;">\n                        <div class="slip-grid-item">\n                            <h3 class="slip-section-title">üè¶ Bank Deposit Details</h3>\n                            <table>\n                                <tr><td>Bank Name:</td><td>${t.bankName}</td></tr>\n                                <tr><td>Account Number:</td><td>${t.accountNumber}</td></tr>\n                                <tr><td>Payment Method:</td><td>Direct Deposit</td></tr>\n                                <tr><td>Currency:</td><td>PHP</td></tr>\n                            </table>\n                        </div>\n                        <div class="slip-grid-item">\n                           <h3 class="slip-section-title">üìå Notes for Verification</h3>\n                           <ul style="font-size: 9pt; padding-left: 20px; margin-top: 10px;">\n                                <li>This slip reflects weekly compensation for a remote employee under a foreign employer.</li>\n                                <li>All Philippine government-mandated deductions are paid by the employee and reimbursed in full by the company.</li>\n                                <li>This document is valid for income verification for housing or car loan applications.</li>\n                                <li>For questions, contact HR at payroll@homeworks.com.</li>\n                           </ul>\n                        </div>\n                    </div>\n\n                    <div class="footer">\n                        <p>HomeWorks Property Management LLC | 100 West Road, Suite 300, Towson, MD 21204</p>\n                    </div>\n                </div>\n            `}function D(e,t){if(!e||!t)return void(u.innerHTML='<p style="color: var(--danger-color);">Could not generate certificate. Data not found.</p>');const a=new Date(document.getElementById("certDate").value).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),l=new Date(t.joinDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});u.innerHTML=`\n                 <div class="certificate" id="certificate-to-print">\n                    <div class="certificate-header">\n                        <div class="logo-area">\n                            <img src="https://github.com/Z-Insights/HomeWorks/blob/main/HWPM%20Logo%203D.png?raw=true" alt="HomeWorks Logo" style="max-height: 70px; border-radius: 8px;">\n                        </div>\n                        <div class="document-title-area">\n                            <h1>Certificate of Employment & Compensation</h1>\n                        </div>\n                    </div>\n                    <div style="padding: 20px; line-height: 1.8; font-size: 12pt;">\n                        <p style="text-align: right;"><strong>Date:</strong> ${a}</p>\n                        <h2 style="text-align: center; font-family: 'Playfair Display', serif; color: var(--primary-color); font-size: 18pt; margin: 30px 0;">TO WHOM IT MAY CONCERN:</h2>\n                        <p>This is to certify that <strong>${t.fullName}</strong> is an active, full-time remote contractor for <strong>HomeWorks Property Management LLC</strong>.</p>\n                        <p>He/She holds the position of <strong>${t.designation}</strong>, and has been engaged with the company since <strong>${l}</strong>.</p>\n                        <p>This certification is issued to attest that for the pay period ending on the date of this certificate, the contractor has an average weekly compensation, inclusive of all bonuses and fees, amounting to approximately <strong>$${e.takeHomePay.toFixed(2)} USD</strong>.</p>\n                        <p>This document is issued upon the request of the aforementioned individual for whatever legal and lawful purpose it may serve.</p>\n                        \n                        <div style="margin-top: 80px;">\n                            <p>Sincerely,</p>\n                            <div style="margin-top: 60px; display: inline-block; border-top: 1px solid #000; padding-top: 5px;">\n                                <strong>Zaphyr Zur Pomicpic</strong><br>\n                                Director of Operations<br>\n                                HomeWorks Property Management LLC\n                            </div>\n                        </div>\n                    </div>\n                     <div class="footer">\n                        <p>HomeWorks Property Management LLC | 100 West Road, Suite 300, Towson, MD 21204</p>\n                        <p>This is a legally binding document. All information contained herein is accurate as of the date of generation.</p>\n                    </div>\n                </div>\n            `}function B(){r.innerHTML="",employeeDatabase.forEach(e=>{const t=document.createElement("tr");t.innerHTML=`\n                    <td>${e.id}</td><td>${e.fullName}</td><td>${e.designation}</td>\n                    <td>${e.company}</td><td>${e.status}</td>\n                    <td>${e.rate?e.rate.toFixed(2):"N/A"}</td>\n                    <td>${e.workEmail}</td><td>${e.joinDate}</td>\n                `,r.appendChild(t)})}H.setDate(H.getDate()+6),document.getElementById("payPeriodStart").valueAsDate=k,document.getElementById("payPeriodEnd").valueAsDate=H,document.getElementById("certDate").valueAsDate=new Date,e.forEach(e=>{e.addEventListener("click",()=>{e.forEach(e=>e.classList.remove("active")),t.forEach(e=>{e.classList.remove("active"),e.classList.remove("animate-fadeIn")}),e.classList.add("active");const a=document.getElementById(`${e.dataset.tab}-tab`);a.classList.add("active"),void a.offsetWidth,a.classList.add("animate-fadeIn")})}),a.addEventListener("change",e=>{h.textContent=e.target.files.length>0?`Selected file: ${e.target.files[0].name}`:""}),l.addEventListener("click",()=>{const e=a.files[0];if(e){currentExchangeRate=parseFloat(document.getElementById("exchangeRate").value)||58.75;const t=new FileReader;t.onload=function(t){let a;try{e.name.endsWith(".xlsx")?(workbook=XLSX.read(t.target.result,{type:"binary"}),sheetName=workbook.SheetNames[0],a=XLSX.utils.sheet_to_json(workbook.Sheets[sheetName],{header:1})):e.name.endsWith(".csv")?(parsed=Papa.parse(t.target.result,{header:!1}),a=parsed.data):function(){throw new Error("Unsupported file type.")}(),x(a)}catch(e){console.error("Error processing file:",e),alert("Error processing file. Please ensure it's a valid .csv or .xlsx file and the format is correct.")}},e.name.endsWith(".xlsx")?t.readAsBinaryString(e):t.readAsText(e)}else alert("Please upload a payroll timesheet file first.")}),c.addEventListener("click",()=>{const e=i.value;if(e){const t=processedPayrollData.find(t=>t.id===e),a=employeeDatabase.find(t=>t.id===e);P(t,a)}else alert("Please select an employee to generate a slip.")}),d.addEventListener("click",()=>{const e=s.value;if(e){const t=processedPayrollData.find(t=>t.id===e),a=employeeDatabase.find(t=>t.id===e);D(t,a)}else alert("Please select an employee to generate a certificate.")}),n.addEventListener("click",()=>{const e=["Employee","Weekly Hours Rendered","Paid TimeOff Hours","Commissions","S-STARS Bonus","Health Card Credit","SSS","Pag Ibig","PhilHealth","Cash Adv/Loans","Compliance Adjustment"],t=["Zaphyr Zur Pomicpic","40","0","50","100","0","10","5","5","0","0"];let a=[e,t].map(e=>e.join(",")).join("\r\n");const l=new Blob([a],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a");void 0!==n.download&&(url=URL.createObjectURL(l),n.setAttribute("href",url),n.setAttribute("download","payroll_template.csv"),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n))}),m.addEventListener("click",()=>{const e=document.getElementById("payroll-tab"),a=e.classList.contains("active");a||e.classList.add("active"),window.print(),a||e.classList.remove("active")}),y.addEventListener("click",()=>{const e=document.getElementById("slip-to-print");e?html2canvas(e).then(e=>{const t=e.toDataURL("image/png"),{jsPDF:a}=window.jspdf,l=new a({orientation:"p",unit:"px",format:[e.width,e.height]});l.addImage(t,"PNG",0,0,e.width,e.height),l.save(`${i.options[i.selectedIndex].text}_slip.pdf`)}):alert("Please generate a slip first.")}),g.addEventListener("click",()=>{const e=document.getElementById("certificate-to-print");e?html2canvas(e).then(e=>{const t=e.toDataURL("image/png"),{jsPDF:a}=window.jspdf,l=new a({orientation:"p",unit:"px",format:[e.width,e.height]});l.addImage(t,"PNG",0,0,e.width,e.height),l.save(`${s.options[s.selectedIndex].text}_certificate.pdf`)}):alert("Please generate a certificate first.")}),b.addEventListener("click",()=>v.classList.add("active")),E.addEventListener("click",()=>v.classList.remove("active")),v.addEventListener("click",e=>{e.target===v&&v.classList.remove("active")}),f.addEventListener("submit",function(e){e.preventDefault();const t=document.getElementById("form-message");t.textContent="Thank you for your message! We will get back to you shortly.",t.style.backgroundColor="var(--secondary-color)",t.style.color="var(--white)",t.style.display="block",f.reset(),setTimeout(()=>{t.style.display="none",v.classList.remove("active")},3e3)}),B()});
    </script>
</body>
</html>
